
<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<p>GDP components over time and among countries</p>
<p>First we will have a look at the Excel file to see how it is structured and organised.</p>
<pre class="r"><code>UN_GDP_data  &lt;-  read_excel(here::here(&quot;data&quot;, &quot;Download-GDPconstant-USD-countries.xls&quot;), # Excel filename
                sheet=&quot;Download-GDPconstant-USD-countr&quot;, # Sheet name
                skip=2) # Number of rows to skip</code></pre>
<pre class="r"><code>#creating a new dataframe  in long format
tidy_GDP_data  &lt;- UN_GDP_data %&gt;% 
  pivot_longer(
               cols=&quot;1970&quot;:&quot;2017&quot;,
               names_to = &quot;year&quot;, 
               values_to= &quot;value&quot;
               ) %&gt;% 
  mutate(year= as.Date(year, &quot;%Y&quot;))


# Let us compare GDP components for these 3 countries
country_list &lt;- c(&quot;United States&quot;,&quot;India&quot;, &quot;Germany&quot;)</code></pre>
<p>Original Plot:</p>
<pre class="r"><code>knitr::include_graphics(here::here(&quot;images&quot;, &quot;gdp1.png&quot;), error = FALSE)</code></pre>
<p><img src="/home/dnaz/Documents/MAM Course/MAM Coursework/Applied Stats/my_website/images/gdp1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>GDP components over time:</p>
<pre class="r"><code>gdp_time &lt;- tidy_GDP_data %&gt;% 
  #filtering for the components of GDP and countries that we need
  filter(Country %in% country_list,
         IndicatorName %in% c(&quot;Gross capital formation&quot;, 
                              &quot;Household consumption expenditure (including Non-profit institutions serving households)&quot;,
                              &quot;Imports of goods and services&quot;,
                              &quot;Exports of goods and services&quot;,
                              &quot;General government final consumption expenditure&quot;)) %&gt;% 
  mutate(value= value/ 1e9) 

#shortening the names of some of the components of GDP to match the plot we are replicating
gdp_time &lt;- gdp_time  %&gt;% 
  mutate(
    IndicatorName= case_when(
      IndicatorName == &quot;Imports of goods and services&quot; ~ &quot;Imports&quot;,
      IndicatorName == &quot;Exports of goods and services&quot; ~ &quot;Exports&quot;,
      IndicatorName == &quot;General government final consumption expenditure&quot; ~ &quot;Government expenditure&quot;,
      IndicatorName == &quot;Household consumption expenditure (including Non-profit institutions serving households)&quot; ~ &quot;Household expenditure&quot;,
      IndicatorName ==&quot;Gross capital formation&quot;~&quot;Gross capital formation&quot;
    ))


ggplot(gdp_time, aes(x=year, y=value, color= IndicatorName)) +
  geom_line(aes(group=IndicatorName))+
  facet_wrap(~Country)+
  theme_bw()+
  labs(
    title = &quot;GDP components over time&quot;,
    subtitle= &quot;In constant 2010 USD&quot;,
    y=&quot;Billion US$&quot;,
    color= &quot;Components of GDP&quot;
  )+
  theme(
    axis.title.x=element_blank()
  )</code></pre>
<p><img src="/blogs/blog6_files/figure-html/GDP_Components_Over_Time,%20fig3-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>Calculation of GDP from its components:</p>
<pre class="r"><code>#calculating GDP as a sum of its components
GDP_Countries &lt;- tidy_GDP_data %&gt;% 
  #filtering for the components of GDP 
  filter(IndicatorName %in% c(&quot;Gross capital formation&quot;, 
                              &quot;Household consumption expenditure (including Non-profit institutions serving households)&quot;,
                              &quot;Imports of goods and services&quot;,
                              &quot;Exports of goods and services&quot;,
                              &quot;General government final consumption expenditure&quot;)) %&gt;%  
  mutate(
    IndicatorName= case_when(
      IndicatorName == &quot;Imports of goods and services&quot; ~ &quot;Imports&quot;,
      IndicatorName == &quot;Exports of goods and services&quot; ~ &quot;Exports&quot;,
      IndicatorName == &quot;General government final consumption expenditure&quot; ~ &quot;Government expenditure&quot;,
      IndicatorName == &quot;Household consumption expenditure (including Non-profit institutions serving households)&quot; ~ &quot;Household expenditure&quot;,
      IndicatorName ==&quot;Gross capital formation&quot;~&quot;Gross capital formation&quot;
    )) %&gt;% 
pivot_wider(names_from= IndicatorName, values_from=value) %&gt;% 
  #calculating net exports
  mutate(net_exports= Exports- Imports, 
         #extracting the year from the date 
         year=year(year)) %&gt;% 
  select(-Imports, -Exports) %&gt;% 
  pivot_longer(
    cols=4:7,
    names_to = &quot;IndicatorName&quot;, 
    values_to= &quot;value&quot;
  ) %&gt;% 
  group_by(year, Country) %&gt;% 
  #summing the components of GDP and assigning to Gross_Domestic_Product
  summarise(Gross_Domestic_Product= sum(value))



GDP_Countries</code></pre>
<pre><code>## # A tibble: 10,560 x 3
## # Groups:   year [48]
##     year Country             Gross_Domestic_Product
##    &lt;dbl&gt; &lt;chr&gt;                                &lt;dbl&gt;
##  1  1970 Afghanistan                    6350432433.
##  2  1970 Albania                        3351761022.
##  3  1970 Algeria                       46680448513.
##  4  1970 Andorra                        1051249180.
##  5  1970 Angola                        23042593319.
##  6  1970 Anguilla                         32264914.
##  7  1970 Antigua and Barbuda             262655839.
##  8  1970 Argentina                    160111327434.
##  9  1970 Armenia                                NA 
## 10  1970 Aruba                           234175779.
## # … with 10,550 more rows</code></pre>
<p>Percentage difference between calculated GDP and the GDP figure included in the dataframe:</p>
<pre class="r"><code>#selecting indicator GDP from UN GDP data
UN_GDP &lt;- UN_GDP_data %&gt;% 
  filter(IndicatorName==&quot;Gross Domestic Product (GDP)&quot;) %&gt;% 
  pivot_longer(
    cols=&quot;1970&quot;:&quot;2017&quot;,
    names_to = &quot;year&quot;, 
    values_to= &quot;value&quot;
  ) %&gt;% 
  rename(United_Nations_Data_GDP= &quot;value&quot;)

GDP_Countries &lt;-
  GDP_Countries %&gt;% 
  mutate(year=as.character(year)) 

#joining the UN GDP values with the calculated GDP and computing the percentage difference
GDP_diff&lt;- inner_join(GDP_Countries, UN_GDP, by=c(&quot;Country&quot;, &quot;year&quot;)) %&gt;% 
  mutate(percentage_difference_in_GDP= (Gross_Domestic_Product-
                                          United_Nations_Data_GDP)/ United_Nations_Data_GDP) %&gt;% 
  select(Country, year, percentage_difference_in_GDP)

paste(&quot;Percentage difference in GDP calculated vs GDP figure included in the dataframe:&quot;)</code></pre>
<pre><code>## [1] &quot;Percentage difference in GDP calculated vs GDP figure included in the dataframe:&quot;</code></pre>
<pre class="r"><code>GDP_diff</code></pre>
<pre><code>## # A tibble: 10,560 x 3
## # Groups:   year [48]
##    Country             year  percentage_difference_in_GDP
##    &lt;chr&gt;               &lt;chr&gt;                        &lt;dbl&gt;
##  1 Afghanistan         1970                      -0.408  
##  2 Albania             1970                      -0.0768 
##  3 Algeria             1970                       0.171  
##  4 Andorra             1970                       0.00429
##  5 Angola              1970                      -0.0383 
##  6 Anguilla            1970                      -0.0728 
##  7 Antigua and Barbuda 1970                      -0.00565
##  8 Argentina           1970                      -0.0871 
##  9 Armenia             1970                      NA      
## 10 Aruba               1970                      -0.0200 
## # … with 10,550 more rows</code></pre>
<p><img src="/home/dnaz/Documents/MAM Course/MAM Coursework/Applied Stats/my_website/images/gdp2.png" width="100%" style="display: block; margin: auto;" /></p>
<p>The graph above compares the change in the proportion of the various components of GDP over time for three countries (India, Germany and USA). We can see that since the 1990’s, India has seen a sharp increase in the proportion of its GDP from gross capital formation an indicator that its economy is growing quickly and it is adding to its fixed assets such as land improvements, roads, railways, machinery etc.</p>
<p>We can also see that Germany has increased the proportion of its GDP from net exports since the early 2000s. Germany now has one of the highest trade surpluses in the world, an indicator of economic strength and competitiveness. Lastly, we can see that proportion of GDP from household expenditure has decreased sharply in India and increased in the US.</p>
<p>GDP and its breakdown at constant 2010 US prices (South Africa, China and South Korea):</p>
<pre class="r"><code>trans_UN_GDP_Data &lt;-  UN_GDP_data %&gt;% 
  #filtering for the components of GDP that we need for 3 selected countries
  filter(Country %in% c(&quot;Republic of Korea&quot;, &quot;China&quot;, &quot;South Africa&quot;),
         IndicatorName %in% c(&quot;Gross capital formation&quot;, 
                              &quot;Household consumption expenditure (including Non-profit institutions serving households)&quot;,
                              &quot;Imports of goods and services&quot;,
                              &quot;Exports of goods and services&quot;,
                              &quot;General government final consumption expenditure&quot;,
                              &quot;Gross Domestic Product (GDP)&quot;)) %&gt;% 
  mutate(
    IndicatorName= case_when(
      IndicatorName == &quot;Imports of goods and services&quot; ~ &quot;Imports&quot;,
      IndicatorName == &quot;Exports of goods and services&quot; ~ &quot;Exports&quot;,
      IndicatorName == &quot;General government final consumption expenditure&quot; ~ &quot;Government_expenditure&quot;,
      IndicatorName == &quot;Household consumption expenditure (including Non-profit institutions serving households)&quot; ~ &quot;Household_expenditure&quot;,
      IndicatorName ==&quot;Gross capital formation&quot;~&quot;Gross_capital_formation&quot;,
      IndicatorName ==&quot;Gross Domestic Product (GDP)&quot;~&quot;GDP&quot;
    )) %&gt;% 
  pivot_longer(
    cols=&quot;1970&quot;:&quot;2017&quot;,
    names_to = &quot;year&quot;, 
    values_to= &quot;value&quot;
  ) %&gt;% 
  mutate(year= as.Date(year, &quot;%Y&quot;)) %&gt;% 
  #changing to wide format to calculate the proportion of GDP for various components
  pivot_wider(names_from = IndicatorName, values_from= &quot;value&quot;) %&gt;% 
  mutate(
    Net_Exports= Exports- Imports,
    perc_NE= Net_Exports/ GDP,
    perc_GE= Government_expenditure/ GDP,
    perc_GCF= Gross_capital_formation/GDP,
    perc_HE= Household_expenditure/GDP
  ) %&gt;% 
  #pivoting back to long format in order to create a time series plot
  pivot_longer(cols= &quot;perc_NE&quot;: &quot;perc_HE&quot;, names_to= &quot;IndicatorName&quot;, values_to= &quot;Proportion&quot;) %&gt;% 
  mutate(
    IndicatorName= case_when(
      IndicatorName == &quot;perc_HE&quot; ~ &quot;Household Expenditure&quot;,
      IndicatorName ==&quot;perc_GCF&quot;~&quot;Gross_capital_formation&quot;,
      IndicatorName ==&quot;perc_NE&quot;~&quot;Net Exports&quot;,
      IndicatorName== &quot;perc_GE&quot;~&quot;Government Expenditure&quot;
    )) 

ggplot(trans_UN_GDP_Data, aes(x=year, y=Proportion, color= IndicatorName)) +
  geom_line(aes(group=IndicatorName))+
  facet_wrap(~Country)+
  theme_bw()+
  labs(
    title = &quot;GDP and its breakdown at constant 2010 prices in US Dollars&quot;,
    y=&quot;proportion&quot;,
    color= &quot;Components of GDP&quot;,
    caption=&quot;Source: United Nations , https://unstats.un.org/unsd/snaama/Downloads&quot;
  )+
  theme(
    axis.title.x=element_blank(),
    legend.title = element_blank()
  )+
  scale_y_continuous(labels = scales::percent)+
  theme_bw()</code></pre>
<p><img src="/blogs/blog6_files/figure-html/Proportion_GDP,%20fig4-1.png" width="960" style="display: block; margin: auto;" /></p>
